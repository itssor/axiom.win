<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>AXIOM // HUB</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Syncopate:wght@700&family=Space+Mono&display=swap');
        body { background: #000; color: #fff; font-family: 'Space Mono', monospace; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }
        .axiom-font { font-family: 'Syncopate', sans-serif; }
        .glass { background: rgba(255, 255, 255, 0.02); border: 1px solid rgba(255, 255, 255, 0.05); backdrop-filter: blur(5px); }
        .scroll-hide::-webkit-scrollbar { display: none; }
    </style>
</head>
<body class="border-t-2 border-purple-600">
    <!-- Loader -->
    <div id="loader" class="fixed inset-0 bg-black z-50 flex flex-col items-center justify-center transition-opacity duration-1000">
        <div class="axiom-font text-5xl text-transparent bg-clip-text bg-gradient-to-r from-white to-purple-600 tracking-tighter mb-8 opacity-0 translate-y-4" id="loader-text">AXIOM</div>
        <div class="w-64 h-[2px] bg-white/5 overflow-hidden relative">
            <div id="loader-bar" class="absolute inset-0 bg-purple-500 w-0"></div>
        </div>
    </div>

    <!-- Nav -->
    <nav class="w-full h-20 border-b border-white/5 flex items-center justify-between px-10 relative z-20 bg-black/50">
        <div class="flex items-center gap-4">
            <div class="axiom-font text-2xl text-transparent bg-clip-text bg-gradient-to-r from-white to-purple-500">AXIOM</div>
            <div class="text-[9px] px-2 py-1 bg-purple-900/20 text-purple-400 rounded border border-purple-500/20">v3.0.0</div>
        </div>
        <div class="flex items-center gap-8">
            <a href="https://discord.gg/axiom" target="_blank" class="text-[10px] opacity-50 hover:opacity-100 transition-all hover:text-purple-400">COMMUNITY</a>
            <a href="login.html" class="text-[10px] opacity-30 hover:opacity-100 transition-all hover:text-white">SYSTEM</a>
        </div>
    </nav>

    <!-- Content -->
    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar -->
        <aside class="w-20 border-r border-white/5 flex-col items-center py-10 hidden md:flex">
             <div class="h-full w-[1px] bg-gradient-to-b from-transparent via-purple-600/50 to-transparent"></div>
        </aside>

        <!-- Main Grid -->
        <main class="flex-1 p-6 md:p-12 overflow-y-auto scroll-hide relative">
            <!-- Search -->
            <div class="mb-8 flex justify-end">
                <div class="relative group w-full max-w-xs">
                    <input type="text" id="search" placeholder="SEARCH_DATABASE..." 
                           class="w-full bg-transparent border-b border-white/10 py-2 text-[10px] font-mono focus:border-purple-500 outline-none transition-all placeholder:opacity-30 text-right">
                    <div class="absolute bottom-0 right-0 w-0 h-[1px] bg-purple-500 transition-all duration-500 group-hover:w-full"></div>
                </div>
            </div>

            <div id="grid" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 pb-20">
                <!-- Loader Skeleton -->
                <div class="glass h-64 rounded-3xl animate-pulse opacity-20"></div>
                <div class="glass h-64 rounded-3xl animate-pulse opacity-20"></div>
                <div class="glass h-64 rounded-3xl animate-pulse opacity-20"></div>
            </div>
        </main>

        <!-- Status Bar -->
        <aside class="w-64 border-l border-white/5 p-8 hidden lg:block bg-black/20">
            <h2 class="text-[9px] axiom-font opacity-20 mb-6 tracking-[0.5em]">STATUS</h2>
            <div class="space-y-4 text-[9px] font-mono">
                <div class="flex justify-between"><span class="opacity-30">CORE</span> <span class="text-green-500">ONLINE</span></div>
                <div class="flex justify-between"><span class="opacity-30">DATABASE</span> <span class="text-green-500">CONNECTED</span></div>
                <div class="flex justify-between"><span class="opacity-30">SECURE</span> <span class="text-purple-500">ENCRYPTED</span></div>
            </div>
            
            <div id="logs" class="mt-10 space-y-2 text-[8px] opacity-30 font-mono h-48 overflow-hidden">
                <p>> INIT_SEQUENCE_START</p>
            </div>
        </aside>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
        import { getFirestore, collection, onSnapshot } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";
        const db = getFirestore(initializeApp({ apiKey: "AIzaSyBykgmRtL2EkqgCJGsiEjP9zO6AQcPA77w", projectId: "axiomdotwin" }));

        const log = (msg) => {
            const l = document.getElementById('logs');
            l.innerHTML = `<p>> ${msg}</p>` + l.innerHTML;
        }

        // Loader Sequence
        const tl = gsap.timeline();
        tl.to("#loader-text", { opacity: 1, y: 0, duration: 1, ease: "power4.out" })
          .to("#loader-bar", { width: "100%", duration: 1.5, ease: "expo.inOut" });

        const hideLoader = () => {
            gsap.to("#loader", { 
                opacity: 0, 
                duration: 1, 
                delay: 0.5, 
                onComplete: () => document.getElementById('loader').remove() 
            });
        };

        onSnapshot(collection(db, "scripts"), (snap) => {
            const g = document.getElementById('grid'); 
            let allDocs = [];
            
            const render = (docs) => {
                g.innerHTML = "";
                let i = 0;
                docs.forEach((doc) => {
                    const s = doc.data(); 
                    const id = doc.id;
                    
                    const card = document.createElement('div');
                    card.className = "glass p-6 rounded-3xl group relative overflow-hidden hover:border-purple-500/50 transition-all duration-500 opacity-0 transform translate-y-10";
                    
                    // Format Date
                    const d = s.date ? new Date(s.date).toLocaleDateString(undefined, {year:'2-digit', month:'2-digit', day:'2-digit'}) : 'UNKNOWN';

                    // Badges
                    let badges = "";
                    if (s.isUniversal) badges += `<span class="px-2 py-1 bg-blue-500/20 text-blue-300 text-[7px] rounded border border-blue-500/30 tracking-wider">UNIV</span>`;
                    if (s.isCracked) badges += `<span class="px-2 py-1 bg-red-500/20 text-red-300 text-[7px] rounded border border-red-500/30 tracking-wider">CRACK</span>`;

                    // Card Content
                    card.innerHTML = `
                        <div class="absolute inset-0 bg-gradient-to-b from-purple-900/10 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-500"></div>
                        <img src="${s.thumb}" class="w-full h-32 object-cover rounded-xl mb-4 opacity-60 group-hover:opacity-100 transition-all duration-500 grayscale group-hover:grayscale-0">
                        <div class="relative z-10">
                            <div class="flex justify-between items-start mb-2">
                                <div>
                                    <h3 class="axiom-font text-xs text-white group-hover:text-purple-300 transition-colors mb-1">${s.name}</h3>
                                    <div class="flex gap-1">${badges}</div>
                                </div>
                                <span class="text-[8px] opacity-20 font-mono">${d}</span>
                            </div>
                            <p class="text-[9px] opacity-40 mb-6 h-8 overflow-hidden leading-relaxed">${s.desc}</p>
                            <button class="w-full py-3 bg-white/5 border border-white/10 text-white/50 font-bold text-[9px] rounded-lg hover:bg-white hover:text-black hover:border-white transition-all tracking-widest">
                                GET_LOADER
                            </button>
                        </div>
                    `;
    
                    // Copy Logic
                    card.querySelector('button').onclick = () => {
                        const code = `_G.AxiomID="${id}";loadstring(game:HttpGet("https://axiom-win.netlify.app/core.lua"))()`;
                        navigator.clipboard.writeText(code);
                        log(`COPIED_${id.slice(0,4).toUpperCase()}`);
                        const btn = card.querySelector('button');
                        const old = btn.innerText;
                        btn.innerText = "COPIED TO CLIPBOARD";
                        btn.classList.add("bg-green-500", "text-white", "border-transparent");
                        setTimeout(() => {
                            btn.innerText = old;
                            btn.classList.remove("bg-green-500", "text-white", "border-transparent");
                        }, 2000);
                    };
    
                    g.appendChild(card);
    
                    // Staggered Animation
                    gsap.to(card, { opacity: 1, y: 0, duration: 0.5, delay: i * 0.05, ease: "power2.out" });
                    i++;
                });
            };

            snap.forEach(doc => allDocs.push(doc));
            render(allDocs);

            // Search Listener
            document.getElementById('search').addEventListener('input', (e) => {
                const term = e.target.value.toLowerCase();
                const filtered = allDocs.filter(doc => {
                    const data = doc.data();
                    return (
                        (data.name && data.name.toLowerCase().includes(term)) || 
                        (data.desc && data.desc.toLowerCase().includes(term)) ||
                        (data.gameName && data.gameName.toLowerCase().includes(term))
                    );
                });
                render(filtered);
            });
            
            log("DATA_SYNC_COMPLETE");
            
            // Wait for loader animation to finish minimum time before hiding
            if (tl.progress() < 1) {
                tl.eventCallback("onComplete", hideLoader);
            } else {
                hideLoader();
            }
        });
    </script>
</body>
</html>